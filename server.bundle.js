!function(e){function t(e){var t=require("./"+e+"."+b+".hot-update.js");f(t.id,t.modules)}function n(){try{var e=require("./"+b+".hot-update.json")}catch(e){return Promise.resolve()}return Promise.resolve(e)}function r(e){delete installedChunks[e]}function o(e){var t=k[e];if(!t)return p;var n=function(n){return t.hot.active?(k[n]?k[n].parents.indexOf(e)<0&&k[n].parents.push(e):(w=[e],y=n),t.children.indexOf(n)<0&&t.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+e),w=[]),p(n)};for(var r in p)Object.prototype.hasOwnProperty.call(p,r)&&"e"!==r&&Object.defineProperty(n,r,function(e){return{configurable:!0,enumerable:!0,get:function(){return p[e]},set:function(t){p[e]=t}}}(r));return n.e=function(e){function t(){L--,"prepare"===O&&(G[e]||s(e),0===L&&0===j&&d())}return"ready"===O&&a("prepare"),L++,p.e(e).then(t,function(e){throw t(),e})},n}function i(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:y!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var r=0;r<e.length;r++)t._acceptedDependencies[e[r]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:c,apply:l,status:function(e){if(!e)return O;_.push(e)},addStatusHandler:function(e){_.push(e)},removeStatusHandler:function(e){var t=_.indexOf(e);t>=0&&_.splice(t,1)},data:x[e]};return y=void 0,t}function a(e){O=e;for(var t=0;t<_.length;t++)_[t].call(null,e)}function u(e){return+e+""===e?+e:e}function c(e){if("idle"!==O)throw new Error("check() is only allowed in idle status");return m=e,a("check"),n().then(function(e){if(!e)return a("idle"),null;Q={},G={},I=e.c,v=e.h,a("prepare");var t=new Promise(function(e,t){h={resolve:e,reject:t}});g={};return s(0),"prepare"===O&&0===L&&0===j&&d(),t})}function f(e,t){if(I[e]&&Q[e]){Q[e]=!1;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(g[n]=t[n]);0==--j&&0===L&&d()}}function s(e){I[e]?(Q[e]=!0,j++,t(e)):G[e]=!0}function d(){a("ready");var e=h;if(h=null,e)if(m)l(m).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&t.push(u(n));e.resolve(t)}}function l(t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];e.indexOf(r)<0&&e.push(r)}}if("ready"!==O)throw new Error("apply() is only allowed in ready status");t=t||{};var o,i,c,f,s,d={},l=[],y={},h=function(){console.warn("[HMR] unexpected require("+S.moduleId+") to disposed module")};for(var m in g)if(Object.prototype.hasOwnProperty.call(g,m)){s=u(m);var S;S=g[m]?function(e){for(var t=[e],r={},o=t.slice().map(function(e){return{chain:[e],id:e}});o.length>0;){var i=o.pop(),a=i.id,u=i.chain;if((f=k[a])&&!f.hot._selfAccepted){if(f.hot._selfDeclined)return{type:"self-declined",chain:u,moduleId:a};if(f.hot._main)return{type:"unaccepted",chain:u,moduleId:a};for(var c=0;c<f.parents.length;c++){var s=f.parents[c],d=k[s];if(d){if(d.hot._declinedDependencies[a])return{type:"declined",chain:u.concat([s]),moduleId:a,parentId:s};t.indexOf(s)>=0||(d.hot._acceptedDependencies[a]?(r[s]||(r[s]=[]),n(r[s],[a])):(delete r[s],t.push(s),o.push({chain:u.concat([s]),id:s})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:r}}(s):{type:"disposed",moduleId:m};var _=!1,j=!1,L=!1,G="";switch(S.chain&&(G="\nUpdate propagation: "+S.chain.join(" -> ")),S.type){case"self-declined":t.onDeclined&&t.onDeclined(S),t.ignoreDeclined||(_=new Error("Aborted because of self decline: "+S.moduleId+G));break;case"declined":t.onDeclined&&t.onDeclined(S),t.ignoreDeclined||(_=new Error("Aborted because of declined dependency: "+S.moduleId+" in "+S.parentId+G));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(S),t.ignoreUnaccepted||(_=new Error("Aborted because "+s+" is not accepted"+G));break;case"accepted":t.onAccepted&&t.onAccepted(S),j=!0;break;case"disposed":t.onDisposed&&t.onDisposed(S),L=!0;break;default:throw new Error("Unexception type "+S.type)}if(_)return a("abort"),Promise.reject(_);if(j){y[s]=g[s],n(l,S.outdatedModules);for(s in S.outdatedDependencies)Object.prototype.hasOwnProperty.call(S.outdatedDependencies,s)&&(d[s]||(d[s]=[]),n(d[s],S.outdatedDependencies[s]))}L&&(n(l,[S.moduleId]),y[s]=h)}var Q=[];for(i=0;i<l.length;i++)s=l[i],k[s]&&k[s].hot._selfAccepted&&Q.push({module:s,errorHandler:k[s].hot._selfAccepted});a("dispose"),Object.keys(I).forEach(function(e){!1===I[e]&&r(e)});for(var M,D=l.slice();D.length>0;)if(s=D.pop(),f=k[s]){var q={},P=f.hot._disposeHandlers;for(c=0;c<P.length;c++)(o=P[c])(q);for(x[s]=q,f.hot.active=!1,delete k[s],c=0;c<f.children.length;c++){var A=k[f.children[c]];A&&((M=A.parents.indexOf(s))>=0&&A.parents.splice(M,1))}}var E,T;for(s in d)if(Object.prototype.hasOwnProperty.call(d,s)&&(f=k[s]))for(T=d[s],c=0;c<T.length;c++)E=T[c],(M=f.children.indexOf(E))>=0&&f.children.splice(M,1);a("apply"),b=v;for(s in y)Object.prototype.hasOwnProperty.call(y,s)&&(e[s]=y[s]);var N=null;for(s in d)if(Object.prototype.hasOwnProperty.call(d,s)){f=k[s],T=d[s];var C=[];for(i=0;i<T.length;i++)E=T[i],o=f.hot._acceptedDependencies[E],C.indexOf(o)>=0||C.push(o);for(i=0;i<C.length;i++){o=C[i];try{o(T)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:s,dependencyId:T[i],error:e}),t.ignoreErrored||N||(N=e)}}}for(i=0;i<Q.length;i++){var H=Q[i];s=H.module,w=[s];try{p(s)}catch(e){if("function"==typeof H.errorHandler)try{H.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:s,error:n,orginalError:e}),t.ignoreErrored||N||(N=n),N||(N=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:s,error:e}),t.ignoreErrored||N||(N=e)}}return N?(a("fail"),Promise.reject(N)):(a("idle"),new Promise(function(e){e(l)}))}function p(t){if(k[t])return k[t].exports;var n=k[t]={i:t,l:!1,exports:{},hot:i(t),parents:(S=w,w=[],S),children:[]};return e[t].call(n.exports,n,n.exports,o(t)),n.l=!0,n.exports}var y,h,g,v,m=!0,b="61d9941833592ad2222a",x={},w=[],S=[],_=[],O="idle",j=0,L=0,G={},Q={},I={},k={};p.m=e,p.c=k,p.i=function(e){return e},p.d=function(e,t,n){p.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},p.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return p.d(t,"a",t),t},p.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},p.p="",p.h=function(){return b},o(22)(p.s=22)}([function(e,t,n){"use strict";var r=n(63),o=function(e){return e&&e.__esModule?e:{default:e}}(r),i=new o.default.Logger({transports:[new o.default.transports.Console({colorize:"all",handleExceptions:!0,json:!1,timestamp:!0})],exitOnError:!1});e.exports=i,e.exports.stream={write:function(e,t){i.info(e)}}},function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("graphql")},function(e,t,n){function r(e){if("string"==typeof e)return e;if(a(e))return i(e,r)+"";if(u(e))return s?s.call(e):"";var t=e+"";return"0"==t&&1/e==-c?"-0":t}var o=n(8),i=n(32),a=n(47),u=n(17),c=1/0,f=o?o.prototype:void 0,s=f?f.toString:void 0;e.exports=r},function(e,t){e.exports=require("graphql-relay")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(1),i=r(o),a=n(25),u=r(a),c=i.default.Schema,f=new c({title:{type:String},num:{type:Number},book:{name:{type:String},abbrv:{type:String},languages:{type:String,many:!0}},lyrics:{type:String},lyrics_Markdown:{md:{type:String},html:{type:String}},tags:{type:String,many:!0},videos:{type:String,many:!0},references:{author:{type:String},book:{type:String},year:{type:String}},partitions:{type:String,many:!0},language:{type:String},songId:{type:String}});f.set("timestamps",{createdAt:"createdAt",updatedAt:"updatedAt"}),f.plugin(u.default),e.exports=i.default.model("Song",f)},function(e,t,n){"use strict";var r=n(2),o=n(4),i=n(12),a=new r.GraphQLObjectType({name:"Song",fields:function(){return{id:(0,o.globalIdField)("Song"),title:{type:r.GraphQLString},num:{type:r.GraphQLInt},book:{type:new r.GraphQLObjectType({name:"Book",fields:function(){return{name:{type:r.GraphQLString},abbrv:{type:r.GraphQLString},languages:{type:r.GraphQLString}}}})},lyrics:{type:r.GraphQLString},lyrics_Markdown:{type:new r.GraphQLObjectType({name:"Markdown",fields:function(){return{md:{type:r.GraphQLString},html:{type:r.GraphQLString}}}})},lyrics_Html:{type:r.GraphQLString},tags:{type:r.GraphQLString},videos:{type:r.GraphQLString},references:{type:new r.GraphQLObjectType({name:"References",fields:function(){return{author:{type:r.GraphQLString},book:{type:r.GraphQLString},year:{type:r.GraphQLString}}}})},partitions:{type:r.GraphQLString},language:{type:r.GraphQLString},songId:{type:r.GraphQLString},meta:{type:new r.GraphQLObjectType({name:"Meta",fields:function(){return{totalViews:{type:r.GraphQLInt},stats:{type:new r.GraphQLList(new r.GraphQLObjectType({name:"Stats",fields:function(){return{week:{type:r.GraphQLInt},year:{type:r.GraphQLInt},day:{type:r.GraphQLInt},views:{type:r.GraphQLInt}}}}))}}}})}}},interfaces:function(){return[i.nodeInterface]}});e.exports=a},function(e,t,n){"use strict";function r(e){return Buffer.from(e,"utf8").toString("base64")}function o(e){return Buffer.from(e,"base64").toString("utf8")}Object.defineProperty(t,"__esModule",{value:!0}),t.base64=r,t.unbase64=o},function(e,t,n){var r=n(44),o=r.Symbol;e.exports=o},function(e,t,n){function r(e){return null==e?"":o(e)}var o=n(3);e.exports=r},function(e,t,n){"use strict";var r=n(7),o=function(e,t){var n=t.map(function(t,n){return{cursor:(0,r.base64)(e.modelName+t.id),node:t}});return{edges:n,pageInfo:i(n)}},i=function(e){return{startCursor:e[0]?e[0].cursor:null,endCursor:e[e.length-1]?e[e.length-1].cursor:null,hasPreviousPage:!1,hasNextPage:!1}};t.connectionFromMongoose=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(0),i=r(o),a=n(5),u=r(a),c=function(e){return u.default.findById(e.id).then(function(e){return e}).catch(function(e){i.default.error(e)})};e.exports={getSong:c}},function(e,t,n){"use strict";var r=n(4),o=n(11),i=(0,r.nodeDefinitions)(function(e){var t=(0,r.fromGlobalId)(e),n=t.type,i=t.id;switch(n){case"Song":return(0,o.getSong)({id:i});default:return null}},function(e){return e.songId?"Song":null}),a=i.nodeInterface,u=i.nodeField;e.exports={nodeInterface:a,nodeField:u}},function(e,t,n){function r(e,t,n){return t===t?a(e,t,n):o(e,i,n)}var o=n(35),i=n(37),a=n(45);e.exports=r},function(e,t,n){function r(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:o(e,t,n)}var o=n(38);e.exports=r},function(e,t,n){function r(e,t){for(var n=-1,r=e.length;++n<r&&o(t,e[n],0)>-1;);return n}var o=n(13);e.exports=r},function(e,t,n){function r(e){return i(e)?a(e):o(e)}var o=n(33),i=n(42),a=n(46);e.exports=r},function(e,t,n){function r(e){return"symbol"==typeof e||i(e)&&o(e)==a}var o=n(36),i=n(49),a="[object Symbol]";e.exports=r},function(e,t,n){function r(e,t,n){if((e=f(e))&&(n||void 0===t))return e.replace(s,"");if(!e||!(t=o(t)))return e;var r=c(e),d=c(t),l=u(r,d),p=a(r,d)+1;return i(r,l,p).join("")}var o=n(3),i=n(14),a=n(39),u=n(15),c=n(16),f=n(9),s=/^\s+|\s+$/g;e.exports=r},function(e,t){e.exports=require("graphql-server-express")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(56),i=r(o),a=n(58),u=r(a),c=n(57),f=r(c),s=n(23),d=r(s),l=n(1),p=r(l),y=n(55),h=r(y),g=n(0),v=r(g),m=n(28),b=r(m),x=n(19),w=n(60),S=r(w),_=(0,u.default)();p.default.Promise=h.default,_.use((0,f.default)()),_.use(i.default.urlencoded({extended:!0})),_.use(i.default.json()),_.use(n(62)("combined",{stream:v.default.stream})),_.use("/graphql",(0,b.default)()),_.use("/graphiql",(0,x.graphiqlExpress)({endpointURL:"/graphql"}));var O=S.default.createServer(_),j=function(){v.default.info("Received kill signal, shutting down gracefully."),d.default.close(),O.close(function(){v.default.info("Closed out remaining connections."),process.exit()}),setTimeout(function(){v.default.error("Could not close connections in time, forcefully shutting down"),process.exit()},1e4)};!function e(){return d.default.start().then(function(){O.listen("4000",function(){v.default.info("API Server is now running on port 4000")})}).catch(function(t){v.default.error(t),setTimeout(function(){e()},5e3)})}(),process.on("SIGTERM",j),process.on("SIGINT",j)},function(e,t){e.exports=require("dotenv")},function(e,t,n){"use strict";n(21).config(),n(20)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),a=n(1),u=function(){function e(){r(this,e),a.Promise=Promise,c(a)}return o(e,[{key:"start",value:function(){return i.info("Starting database"),a.connect("mongodb://rest:r4Yj1n52JwT7z6H@cluster0-shard-00-00-xd1x4.mongodb.net:27017,cluster0-shard-00-01-xd1x4.mongodb.net:27017,cluster0-shard-00-02-xd1x4.mongodb.net:27017/cesperance?ssl=true&replicaSet=Cluster0-shard-0&authSource=admin",{useMongoClient:!0})}},{key:"close",value:function(){return a.connection.close()}}]),e}(),c=function(e){e.connection.on("connecting",function(){i.info("Connecting to the database")}),e.connection.on("connected",function(){i.info("Connected to the database")}),e.connection.on("open",function(){i.info("onOpen")}),e.connection.on("disconnecting",function(){i.warn("Disconnecting from the database")}),e.connection.on("Disconnected",function(){i.warn("Disconnected from the dataabse"),e.connect("mongodb://rest:r4Yj1n52JwT7z6H@cluster0-shard-00-00-xd1x4.mongodb.net:27017,cluster0-shard-00-01-xd1x4.mongodb.net:27017,cluster0-shard-00-02-xd1x4.mongodb.net:27017/cesperance?ssl=true&replicaSet=Cluster0-shard-0&authSource=admin",config.mongoose.options)}),e.connection.on("closed",function(){i.info("DB connection closed")}),e.connection.on("reconnected",function(){i.info("Reconnected to the database")}),e.connection.on("error",function(t){i.error("Connection to the database failed with "+t),e.disconnect()})},f=new u;e.exports=f},function(e,t,n){"use strict";var r=n(1),o=n(1).Schema,i=new o({song_id:{type:o.Types.ObjectId,ref:"Song"},views:{type:Number,default:0},date:{year:{type:Number},week:{type:Number},day:{type:Number,min:1,max:7}}},{collection:"song_meta"});i.set("timestamps",{createdAt:"created_at",updatedAt:"updated_at"}),i.set("retainKeyOrder",!0);var a=r.model("Song_Meta",i);e.exports=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(61),i=r(o),a=n(1),u=r(a),c=n(0),f=r(c),s=u.default.Types.ObjectId,d=function(){return{totalViews:1,stats:[{year:(0,i.default)().year(),week:(0,i.default)().isoWeek(),day:(0,i.default)().isoWeekday(),views:1}]}};e.exports=function(e,t){e.add({meta:{totalViews:{type:Number,default:0},stats:[{year:{type:Number},week:{type:Number},day:{type:Number,min:1,max:7},views:{type:Number}}]}}),e.post("findOne",function(e){var t=[];if(e.meta.stats&&(t=e.meta.stats.pop(),f.default.warn("LAST ITEM: "+JSON.stringify(t))),t)if(t.year===(0,i.default)().year()&&t.week===(0,i.default)().isoWeek()&&t.day===(0,i.default)().isoWeekday())u.default.model("Song").findOneAndUpdate({_id:s(e._id),"meta.stats":{$elemMatch:{year:(0,i.default)().year(),week:(0,i.default)().isoWeek(),day:(0,i.default)().isoWeekday()}}},{$inc:{"meta.stats.$.views":1,"meta.totalViews":1}}).then(function(e){}).catch(function(e){f.default.log("error",e)});else{var n={year:(0,i.default)().year(),week:(0,i.default)().isoWeek(),day:(0,i.default)().isoWeekday(),views:1};u.default.model("Song").updateOne({_id:s(e._id)},{$addToSet:{"meta.stats":n},$inc:{"meta.totalViews":1}}).then(function(e){}).catch(function(e){f.default.log("error",e)})}else{var r=d();f.default.warn("NEW META: "+JSON.stringify(r)),u.default.model("Song").updateOne({_id:s(e._id)},{$set:{meta:r}})}}),t&&t.index&&(e.path("meta").index({"meta.stats.year":1,"meta.stats.week":1,"meta.stats.day":1},{unique:!0}),e.path("meta").index({"meta.totalViews":1}))}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(2),a=n(4),u=n(6),c=r(u),f=n(30),s=n(5),d=r(s),l=n(0),p=r(l),y=n(10),h=function(e,t){return{type:(0,a.connectionDefinitions)({name:e,nodeType:c.default,connectionFields:function(){return{totalCount:{type:i.GraphQLInt,resolve:function(e){return e.totalCount},description:'A count of the total number of objects in this connection, ignoring pagination.\nThis allows a client to fetch the first five objects by passing "5" as the\nargument to "first", then fetch the total count so it could display "5 of 83",\nfor example.'}}}}).connectionType,args:o({},a.connectionArgs,{book:{type:i.GraphQLString},language:{type:i.GraphQLString},num:{type:i.GraphQLString},title:{type:i.GraphQLString},songId:{type:i.GraphQLString},order_by:{type:i.GraphQLString}}),resolve:function(e,t){return(0,f.getSongs)(t,null,null).then(function(e){return(0,y.connectionFromMongoose)(d.default,e)}).catch(function(e){p.default.error(e)})}}};t.songConnection=h},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(4),i=n(2),a=n(6),u=function(e){return e&&e.__esModule?e:{default:e}}(a),c=n(29),f=function(e,t){return{type:(0,o.connectionDefinitions)({name:e,nodeType:u.default}).connectionType,args:r({},o.connectionArgs,{song_id:{type:i.GraphQLString},day:{type:i.GraphQLInt},week:{type:i.GraphQLInt},year:{type:i.GraphQLInt},direction:{type:i.GraphQLString},_day:{type:i.GraphQLInt},_week:{type:i.GraphQLInt},_year:{type:i.GraphQLInt}}),resolve:function(e,t){return(0,c.getSongMeta)(t,null,null)}}};t.songMetaConnection=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(31),i=r(o),a=n(19),u=n(59),c=(r(u),n(2)),f=c.GraphQLSchema;e.exports=function(){var e=new f({query:i.default});return(0,a.graphqlExpress)(function(t){return{schema:e,graphiql:!0}})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(50),i=r(o),a=n(18),u=r(a),c=n(54),f=r(c),s=n(0),d=r(s),l=n(7),p=n(10),y=n(24),h=r(y),g=function(e){var t=e.after,n=e.before,r=e.first,o=e.last,a=e.orderby,c={},s=void 0,y={},g=(0,f.default)(a,"-");if(a&&((0,i.default)(a,"-")?c[g]=-1:c[g]=1,delete e.orderby),r&&(s=r,delete e.first),o&&(s=o,c[g]=-c[g],delete e.last),t){var v=(0,u.default)((0,l.unbase64)(t),h.default.modelName+":");y._id={$gt:v},delete e.after}if(n){var m=(0,u.default)((0,l.unbase64)(n),h.default.modelName+":");y._id={$lt:m},delete e.before}for(var b in e)null===e[b]&&delete e[b];return Object.assign(y,e),void 0!==s?h.default.find(y).sort(c).limit(s).exec().then(function(e){return(0,p.connectionFromMongoose)(h.default,e)}).catch(function(e){d.default.log("error",e)}):h.default.find(y).sort(c).exec().then(function(e){return(0,p.connectionFromMongoose)(h.default,e)}).catch(function(e){d.default.log("error",e)})};e.exports={getTotalViews:g}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(18),i=r(o),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=n(7),c=n(5),f=r(c),s=function(e,t,n){var r={before:e.before,after:e.after,first:e.first,last:e.last},o=e.order_by;delete e.before,delete e.after,delete e.last,delete e.first,delete e.order_by;var c=a({},e);c.book&&(c["book.abbrv"]=c.book,delete c.book);var s={};o&&(s[o]=1);var d=void 0;if(r.first&&(d=r.first,delete e.first),r.last&&(d=r.last,o?s[o]=-1:s._id=-1),r.after){var l=(0,i.default)((0,u.unbase64)(r.after),f.default.modelName+":");c._id={$gt:l}}if(r.before){var p=(0,i.default)((0,u.unbase64)(r.before),f.default.modelName+":");c._id={$lt:p}}return void 0!==d?o?f.default.find(c).sort(s).limit(d):f.default.find(c).limit(d):o?f.default.find(c).sort(s):f.default.find(c)};e.exports={getSongs:s}},function(e,t,n){"use strict";var r=n(2),o=n(6),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=n(12),u=n(26),c=n(27),f=n(11),s=new r.GraphQLObjectType({name:"Query",fields:function(){return{node:a.nodeField,songs:(0,u.songConnection)("Songs","songs"),song:{type:i.default,args:{id:{type:new r.GraphQLNonNull(r.GraphQLID)}},resolve:function(e,t){return(0,f.getSong)(t)}},songsMeta:(0,c.songMetaConnection)("Meta","songs")}}});e.exports=s},function(e,t){function n(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}e.exports=n},function(e,t){function n(e){return e.split("")}e.exports=n},function(e,t){function n(e,t,n){return e===e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}e.exports=n},function(e,t){function n(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}e.exports=n},function(e,t,n){function r(e){return null==e?void 0===e?c:u:f&&f in Object(e)?i(e):a(e)}var o=n(8),i=n(41),a=n(43),u="[object Null]",c="[object Undefined]",f=o?o.toStringTag:void 0;e.exports=r},function(e,t){function n(e){return e!==e}e.exports=n},function(e,t){function n(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),n=n>o?o:n,n<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+t];return i}e.exports=n},function(e,t,n){function r(e,t){for(var n=e.length;n--&&o(t,e[n],0)>-1;);return n}var o=n(13);e.exports=r},function(e,t){var n="object"==typeof global&&global&&global.Object===Object&&global;e.exports=n},function(e,t,n){function r(e){var t=a.call(e,c),n=e[c];try{e[c]=void 0;var r=!0}catch(e){}var o=u.call(e);return r&&(t?e[c]=n:delete e[c]),o}var o=n(8),i=Object.prototype,a=i.hasOwnProperty,u=i.toString,c=o?o.toStringTag:void 0;e.exports=r},function(e,t){function n(e){return r.test(e)}var r=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=n},function(e,t){function n(e){return o.call(e)}var r=Object.prototype,o=r.toString;e.exports=n},function(e,t,n){var r=n(40),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},function(e,t){function n(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}e.exports=n},function(e,t){function n(e){return e.match(d)||[]}var r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",o="\\ud83c[\\udffb-\\udfff]",i="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",u="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",c="(?:\\u200d(?:"+["[^\\ud800-\\udfff]",i,a].join("|")+")[\\ufe0e\\ufe0f]?"+u+")*",f="[\\ufe0e\\ufe0f]?"+u+c,s="(?:"+["[^\\ud800-\\udfff]"+r+"?",r,i,a,"[\\ud800-\\udfff]"].join("|")+")",d=RegExp(o+"(?="+o+")|"+s+f,"g");e.exports=n},function(e,t){var n=Array.isArray;e.exports=n},function(e,t){function n(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}e.exports=n},function(e,t){function n(e){return null!=e&&"object"==typeof e}e.exports=n},function(e,t,n){function r(e,t,n){return e=u(e),n=null==n?0:o(a(n),0,e.length),t=i(t),e.slice(n,n+t.length)==t}var o=n(34),i=n(3),a=n(52),u=n(9);e.exports=r},function(e,t,n){function r(e){if(!e)return 0===e?e:0;if((e=o(e))===i||e===-i){return(e<0?-1:1)*a}return e===e?e:0}var o=n(53),i=1/0,a=1.7976931348623157e308;e.exports=r},function(e,t,n){function r(e){var t=o(e),n=t%1;return t===t?n?t-n:t:0}var o=n(51);e.exports=r},function(e,t,n){function r(e){if("number"==typeof e)return e;if(i(e))return a;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(u,"");var n=f.test(e);return n||s.test(e)?d(e.slice(2),n?2:8):c.test(e)?a:+e}var o=n(48),i=n(17),a=NaN,u=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,s=/^0o[0-7]+$/i,d=parseInt;e.exports=r},function(e,t,n){function r(e,t,n){if((e=c(e))&&(n||void 0===t))return e.replace(f,"");if(!e||!(t=o(t)))return e;var r=u(e),s=a(r,u(t));return i(r,s).join("")}var o=n(3),i=n(14),a=n(15),u=n(16),c=n(9),f=/^\s+/;e.exports=r},function(e,t){e.exports=require("bluebird")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("compression")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("express-graphql")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("moment")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("winston")}]);